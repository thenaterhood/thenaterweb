<html>
    <head>
        <script
            type="text/javascript"
            src="../../js/jquery-1.4.2.min.js">
        </script>
        <script
            type="text/javascript"
            src="../../syntax_highlighter/scripts/shCore.js">
        </script>
        <script
            type="text/javascript"
            src="../../syntax_highlighter/scripts/shBrushJScript.js">
        </script>
        <script
            type="text/javascript"
            src="../../syntax_highlighter/scripts/shBrushPhp.js">
        </script>
        <script
            type="text/javascript"
            src="../../syntax_highlighter/scripts/shBrushXml.js">
        </script>
        <link
            href="../../syntax_highlighter/styles/shCore.css" rel="stylesheet"
            type="text/css"
        />
        <link
            href="../../syntax_highlighter/styles/shCoreEclipse.css"
            rel="stylesheet" type="text/css"
        />
        <link
            href="../../syntax_highlighter/styles/shThemeWordpress.css"
            rel="stylesheet" type="text/css"
        />
    </head>
    <body>
        <pre class="brush: php">&lt;?php
/**
 * Provides resources for sanitizing user input, including removing
 * garbage characters, truncating strings to fit in their location, 
 * and providing various outputs in an html safe form if requested.
 * @author Nate Levesque &lt;public@thenaterhood.com&gt;
 */


/**
 * Manages sanitizing user input.  Currently works only for strings,
 * but adding functions to sanitize other data types is trivial.
 * Retrieving sanitized values from the class involves invoking
 * the __get function with the type, str, arr, bool, etc for whichever
 * sanitation functions are implemented. The sanitization for the
 * requested return is called (returns an empty object if the 
 * sanitization can't convert the current one to the requested one).
 */
class sanitation{

	/**
	 * @var $dirty (str) - the string retrieved
	 * @var $length (int) - the maximum allowed length of the string
	 */
	protected $dirty, $length;
	
	/**
	 * Constructs an instance of the class
	 * containing the original variable and the sanitized
	 * variable
	 * 
	 * @param $rawVar (str) - the raw variable contents
	 * @param $length (int) - a maximum length for the variable
	 * 
	 */
	public function __construct($rawVar, $length){

		$this-&gt;dirty = $rawVar;
		$this-&gt;length = $length;
		
	}
	
	/**
	 * Returns a sanitized version of the variable.  If the requested
	 * type is not the same as the actual type, the class will
	 * attempt to convert it to the type if possible. Note that
	 * list cannot become a string.
	 * 
	 * @param $type - the type of data to return (str, bool, arr, etc)
	 * 
	 * @return - a sanitized variable
	 * 
	 */
	public function __get($type){
		
		return $this-&gt;$type();
	}
	
	/**
	* Verify that a string is made of html-safe characters and
	* short enough to fit where it belongs.  Basically some simple
	* input sanitizing for nonsecure things.
	* 
	*/
	private function str() {
		# Check that the string is actually a string, return &quot;&quot; if not
		if (gettype($this-&gt;dirty) != 'string'){
			return '';
		}
		
		#Santize input so that it's text so we don't have XSS problems
		$safestring = preg_replace('/[^a-zA-Z0-9\s.:-]/', '', $this-&gt;dirty);
	
		$saferstring = htmlspecialchars($safestring, ENT_QUOTES);
		
		#Check the length of the string and the limit given, truncate if needed
		if ($this-&gt;length == 0){
			return $saferstring;
		}
		if (strlen($saferstring) &gt; $this-&gt;length){
			return substr($saferstring, 0, $this-&gt;length);
		}
		else {
			return $saferstring;
		}
	}
	
	/**
	 * Returns an integer created from the data
	 */
	private function num(){
		
		return (int) $this-&gt;dirty;
	}
	
	/**
	 * Return a simple boolean based on the variable
	 */
	private function boo(){
		
		if ( $this-&gt;dirty and $this-&gt;dirty != &quot;False&quot; ){
			return True;
		}
		else{ 
			return False; 
		}
		
	}
}
?&gt;
</pre>
        <script type="text/javascript">
             SyntaxHighlighter.all()
             jQuery('.gutter div').each(function(key, data){
                jQuery(data).prepend('<a name="L'+jQuery(data).text()+'"/>');
             });
        </script>
    </body>
</html>