<html>
    <head>
        <script
            type="text/javascript"
            src="../../js/jquery-1.4.2.min.js">
        </script>
        <script
            type="text/javascript"
            src="../../syntax_highlighter/scripts/shCore.js">
        </script>
        <script
            type="text/javascript"
            src="../../syntax_highlighter/scripts/shBrushJScript.js">
        </script>
        <script
            type="text/javascript"
            src="../../syntax_highlighter/scripts/shBrushPhp.js">
        </script>
        <script
            type="text/javascript"
            src="../../syntax_highlighter/scripts/shBrushXml.js">
        </script>
        <link
            href="../../syntax_highlighter/styles/shCore.css" rel="stylesheet"
            type="text/css"
        />
        <link
            href="../../syntax_highlighter/styles/shCoreEclipse.css"
            rel="stylesheet" type="text/css"
        />
        <link
            href="../../syntax_highlighter/styles/shThemeWordpress.css"
            rel="stylesheet" type="text/css"
        />
    </head>
    <body>
        <pre class="brush: php">&lt;?php
/**
 * Contains classes and functions for retrieving, displaying, and
 * managing blog posts and other aspects of the blog platform
 * 
 * @author Nate Levesque &lt;public@thenaterhood.com&gt;
 * Language: PHP
 * Filename: core_blog.php
 * 
 */

/**
 * Includes the core_web functions
 */
include_once GNAT_ROOT.'/lib/core_web.php';
include_once GNAT_ROOT.'/classes/class_article.php';
include_once GNAT_ROOT.'/classes/class_inventory.php';

/**
* Returns a random line of a given file.
* Used mainly for generating random suggestions 
* for additional blog posts to read.
* 
* @param $filename - a filename to pull a line from
*/
function RandomLine($filename) {

	$lines = file($filename) ;
	return $lines[array_rand($lines)] ;
}

/**
* Generates and displays a list of additional 'suggested' blog
* posts.  Right now picks them randomly, but in the future might
* rely on a better algorithm.
* 
* @param $number (int): how many to generate and display
* @param $tag (string): a tag or tags to use for generating suggestions
*/
function getSuggestions($number, $tag, $post_directory){

		$inventory = new inventory( $post_directory, NULL );

		$pool = $inventory-&gt;selectField( 'title' );

		$i = 0;
		while ($i &lt; $number){
			$posts = $inventory-&gt;select( 'title', $pool[array_rand($pool)] );
			$post = $posts[0];
			print '&lt;li&gt;&lt;a href=&quot;'.htmlentities( $post['link'] ).'&quot;&gt;'.$post['title'].'&lt;/a&gt;&lt;/li&gt;';
			$i++;
		}
		
	}

/**
 * Lists the files in a directory and returns an array of them
 * out to the given length section
 * 
 * @param $start (int) - a starting index for the files
 * @param $end (int) - an ending index for the files
 * 
 * @return $posts (array) - an array of post objects
 * 
 */
function getPosts( $bloguri, $post_directory, $start, $end){

	$inventory = new inventory( $post_directory, $bloguri );
	$posts = $inventory-&gt;getFileList();
	
	for ($i = $start; $i &lt; count($posts) &amp;&amp; $i &lt; $end; $i++){
		$nextpost = new article( $post_directory.'/'.$posts[$i], $bloguri );
		echo $nextpost-&gt;output( 'html' );
		echo &quot;&lt;hr /&gt;&quot;;
	}
	if (! $start &lt;= 0) echo &quot;&lt;a href='?start=&quot;.($start - getConfigOption('posts_per_page') ).&quot;&amp;amp;end=&quot;.($end - getConfigOption('posts_per_page') ).&quot;'&gt;Newer Posts&lt;/a&gt;&quot;;
	if (! $start &lt;= 0 and count($posts) != $i ) echo ' / ';
	if ( count($posts) != $i ) echo &quot;&lt;a href='?start=&quot;.($start + getConfigOption('posts_per_page') ).&quot;&amp;amp;end=&quot;.($end + getConfigOption('posts_per_page') ).&quot;'&gt;  Older Posts&lt;/a&gt;  &quot;;

}

?&gt;
</pre>
        <script type="text/javascript">
             SyntaxHighlighter.all()
             jQuery('.gutter div').each(function(key, data){
                jQuery(data).prepend('<a name="L'+jQuery(data).text()+'"/>');
             });
        </script>
    </body>
</html>